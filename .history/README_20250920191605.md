# üîí Unsafe File Scanner

[![Python Version](https://img.shields.io/badge/python-3.8%2B-blue.svg)](https://python.org)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Platform](https://img.shields.io/badge/platform-Windows%20%7C%20Linux%20%7C%20macOS-lightgrey.svg)](https://github.com/Rohithvicky/unsafe-file-scanner)

A professional security tool for detecting files with unsafe permissions and potential security vulnerabilities. Built with Python and featuring both command-line and graphical interfaces.

## ‚ú® Features

### üîç **File Permission Analysis**
- **SUID/SGID Detection**: Identifies files with Set User ID and Set Group ID permissions
- **World-Writable Files**: Detects files writable by all users (major security risk)
- **Non-Owner Writable Files**: Finds files writable by users other than the owner
- **Permission Risk Assessment**: Categorizes files by risk levels (CRITICAL, HIGH, MEDIUM, LOW)

### üñ•Ô∏è **Professional GUI Interface**
- **Modern Design**: Clean, intuitive two-panel layout
- **Real-time Status**: Live progress tracking and status indicators
- **Tabbed Results**: Summary, detailed results, and raw JSON views
- **Advanced Controls**: Real-time monitoring and rule management

### ‚ö° **Real-time Monitoring**
- **Live Detection**: Uses `watchdog` library for real-time file system monitoring
- **Alert System**: Instant notifications for security threats
- **Result Management**: View, export, and manage accumulated results

### üõ°Ô∏è **Advanced Security Features**
- **Customizable Rule Engine**: 15+ built-in security rules with custom rule support
- **Multi-format Export**: JSON, CSV, and HTML report generation
- **Cross-platform Support**: Works on Windows, Linux, and macOS
- **Professional Logging**: Comprehensive audit trails

## üöÄ Quick Start

### Installation

#### Option 1: From GitHub (Recommended)
```bash
git clone https://github.com/Rohithvicky/unsafe-file-scanner.git
cd unsafe-file-scanner
pip install -e .
```

#### Option 2: Direct pip Installation
```bash
pip install git+https://github.com/Rohithvicky/unsafe-file-scanner.git
```

#### Option 3: Using Installation Scripts
```bash
# Linux/macOS
chmod +x install.sh
./install.sh

# Windows
install.bat
```

### Usage

#### Command Line Interface
```bash
# Basic scan
unsafe-file-scanner /path/to/scan

# With options
unsafe-file-scanner --output results.json --verbose /path/to/scan

# Short command
ufs /path/to/scan
```

#### Graphical User Interface
```bash
# Launch GUI
unsafe-file-scanner-gui

# Short command
ufs-gui
```

## üìñ Documentation

### Command Line Options
```bash
usage: unsafe-file-scanner [-h] [--output OUTPUT] [--verbose] [--log-level LOG_LEVEL] [--config CONFIG] directories [directories ...]

Professional Security Tool for File Permission Analysis

positional arguments:
  directories           Directories to scan for unsafe files

options:
  -h, --help            show this help message and exit
  --output OUTPUT, -o OUTPUT
                        Output file for scan results (default: scan_results.json)
  --verbose, -v         Enable verbose output
  --log-level LOG_LEVEL
                        Set logging level (DEBUG, INFO, WARNING, ERROR)
  --config CONFIG, -c CONFIG
                        Configuration file path
```

### GUI Features

#### **Scan Configuration Panel**
- **Target Directories**: Add multiple directories to scan
- **Output File**: Specify where to save results
- **Control Buttons**: Start, stop, clear, and export operations

#### **Advanced Features**
- **Real-time Monitor**: Live file system monitoring
- **Rule Manager**: Configure custom security rules
- **Export Format**: Choose between JSON, CSV, or HTML

#### **Results Display**
- **Summary Tab**: Overview of scan results and statistics
- **Detailed Results**: Table view of all unsafe files found
- **Raw JSON**: Complete scan data in JSON format

## üîß Configuration

### Basic Configuration
Create a `config.json` file:
```json
{
    "output_file": "scan_results.json",
    "verbose": false,
    "log_level": "INFO",
    "max_file_size": 10485760,
    "exclude_patterns": ["*.tmp", "*.log"],
    "include_hidden": false
}
```

### Advanced Configuration
Create an `advanced_config.json` file for rule engine settings:
```json
{
    "rules_file": "rules.json",
    "enable_realtime": true,
    "monitor_interval": 1.0,
    "alert_threshold": "MEDIUM"
}
```

## üõ†Ô∏è Development

### Prerequisites
- Python 3.8 or higher
- pip (Python package manager)

### Setup Development Environment
```bash
# Clone repository
git clone https://github.com/Rohithvicky/unsafe-file-scanner.git
cd unsafe-file-scanner

# Create virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install in development mode
pip install -e .

# Install development dependencies
pip install -r requirements-dev.txt
```

### Running Tests
```bash
python -m pytest tests/
```

### Building Package
```bash
python -m build
```

## üìä Export Formats

### JSON Format
```json
{
    "summary": {
        "total_files": 1000,
        "unsafe_files": 5,
        "scan_duration": 2.5
    },
    "files": [
        {
            "path": "/path/to/file",
            "permissions": "rwxrwxrwx",
            "owner": "user",
            "group": "group",
            "risk_level": "HIGH",
            "issues": ["World-writable"]
        }
    ]
}
```

### CSV Format
```csv
File Path,Permissions,Owner,Group,Size (bytes),Modified Time,Risk Level,Issues
/path/to/file,rwxrwxrwx,user,group,1024,2024-01-01 12:00:00,HIGH,"World-writable"
```

### HTML Format
Professional HTML report with tables, styling, and interactive elements.

## üîí Security Rules

The tool includes 15+ built-in security rules:

1. **SUID Binary Detection**
2. **SGID Binary Detection**
3. **World-Writable Files**
4. **Non-Owner Writable Files**
5. **Executable Scripts in Public Directories**
6. **Suspicious File Extensions**
7. **Large File Detection**
8. **Hidden File Analysis**
9. **Permission Anomalies**
10. **And more...**

## üåê Cross-Platform Support

| Platform | Status | Notes |
|----------|--------|-------|
| **Windows** | ‚úÖ Full Support | GUI and CLI working |
| **Linux** | ‚úÖ Full Support | All features available |
| **macOS** | ‚úÖ Full Support | Native compatibility |

## üìà Performance

- **Fast Scanning**: Optimized algorithms for large directory trees
- **Memory Efficient**: Streams large files without loading into memory
- **Real-time Monitoring**: Low-latency file system event detection
- **Concurrent Processing**: Multi-threaded scanning for better performance

## ü§ù Contributing

We welcome contributions! Please see our [Contributing Guidelines](CONTRIBUTING.md) for details.

### How to Contribute
1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## üìù License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## üôè Acknowledgments

- Built with Python and tkinter
- Real-time monitoring powered by `watchdog`
- Inspired by security best practices and file integrity monitoring tools

## üìû Support

- **Documentation**: [Wiki](https://github.com/Rohithvicky/unsafe-file-scanner/wiki)
- **Issues**: [GitHub Issues](https://github.com/Rohithvicky/unsafe-file-scanner/issues)
- **Discussions**: [GitHub Discussions](https://github.com/Rohithvicky/unsafe-file-scanner/discussions)

## üîÑ Changelog

### Version 1.0.0
- Initial release
- Core file permission analysis
- Professional GUI interface
- Real-time monitoring
- Advanced rule engine
- Multi-format export
- Cross-platform support

---

**Made with ‚ù§Ô∏è for the security community**